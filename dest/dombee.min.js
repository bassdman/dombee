var Dombee=function(){"use strict";function e(e,t){const n="function"==typeof e?e.toString():e;return Object.keys(t).filter(e=>n.match(new RegExp("\\b"+e+"\\b")))}function t(e,t){const n=Object.keys(t);return Function(...n,"return "+e+";")}function n(e,t){const n=Object.keys(t);return Function(...n,"return `"+e+"`;")}function r(e,{state:t,values:n}){if(null==e)throw new Error("Dombee.directive(config) failed. The first parameter must be a config object or function, but is null.");let r=e;if("function"==typeof e){if(r=e({state:t,data:n}),null==r)throw new Error("Dombee.directive(config) failed. Your first parameter is a function ("+e+") but it returns null. Did you forget to return the configuration?");r.name=e.name}if(null==r.onChange)throw new Error('Dombee.directive(config) failed. Your directive config needs property "onChange" to be initialized successfully.');if("function"!=typeof r.onChange)throw new Error("Dombee.directive(config) failed. config.onChange must be a function.");if("function"!=typeof r.expressions)throw new Error("Dombee.directive(config) failed. config.expressions must be a function. But it is typeof "+typeof e.expressions);return r}function o(e=""){return e+Math.random().toString(36).substring(2,15)}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var a=function(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}((function(e,t){var n="[object Arguments]",r="[object Function]",o="[object GeneratorFunction]",a="[object Map]",s="[object Set]",c=/\w*$/,u=/^\[object .+?Constructor\]$/,f=/^(?:0|[1-9]\d*)$/,l={};l[n]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object DataView]"]=l["[object Boolean]"]=l["[object Date]"]=l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l[a]=l["[object Number]"]=l["[object Object]"]=l["[object RegExp]"]=l[s]=l["[object String]"]=l["[object Symbol]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l["[object Error]"]=l[r]=l["[object WeakMap]"]=!1;var d="object"==typeof i&&i&&i.Object===Object&&i,p="object"==typeof self&&self&&self.Object===Object&&self,y=d||p||Function("return this")(),b=t&&!t.nodeType&&t,h=b&&e&&!e.nodeType&&e,v=h&&h.exports===b;function g(e,t){return e.set(t[0],t[1]),e}function _(e,t){return e.add(t),e}function j(e,t,n,r){var o=-1,i=e?e.length:0;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function m(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function x(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function w(e,t){return function(n){return e(t(n))}}function A(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var E,O=Array.prototype,T=Function.prototype,k=Object.prototype,S=y["__core-js_shared__"],C=(E=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"",D=T.toString,$=k.hasOwnProperty,F=k.toString,L=RegExp("^"+D.call($).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),I=v?y.Buffer:void 0,P=y.Symbol,M=y.Uint8Array,N=w(Object.getPrototypeOf,Object),B=Object.create,U=k.propertyIsEnumerable,W=O.splice,q=Object.getOwnPropertySymbols,R=I?I.isBuffer:void 0,V=w(Object.keys,Object),z=he(y,"DataView"),J=he(y,"Map"),H=he(y,"Promise"),Y=he(y,"Set"),G=he(y,"WeakMap"),K=he(Object,"create"),Q=me(z),X=me(J),Z=me(H),ee=me(Y),te=me(G),ne=P?P.prototype:void 0,re=ne?ne.valueOf:void 0;function oe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ie(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ae(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function se(e){this.__data__=new ie(e)}function ce(e,t){var r=we(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ae(e)}(e)&&$.call(e,"callee")&&(!U.call(e,"callee")||F.call(e)==n)}(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],o=r.length,i=!!o;for(var a in e)!t&&!$.call(e,a)||i&&("length"==a||_e(a,o))||r.push(a);return r}function ue(e,t,n){var r=e[t];$.call(e,t)&&xe(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function fe(e,t){for(var n=e.length;n--;)if(xe(e[n][0],t))return n;return-1}function le(e,t,i,u,f,d,p){var y;if(u&&(y=d?u(e,f,d,p):u(e)),void 0!==y)return y;if(!Te(e))return e;var b=we(e);if(b){if(y=function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&$.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!t)return function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(e,y)}else{var h=ge(e),v=h==r||h==o;if(Ee(e))return function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(e,t);if("[object Object]"==h||h==n||v&&!d){if(m(e))return d?e:{};if(y=function(e){return"function"!=typeof e.constructor||je(e)?{}:(t=N(e),Te(t)?B(t):{});var t}(v?{}:e),!t)return function(e,t){return ye(e,ve(e),t)}(e,function(e,t){return e&&ye(t,ke(t),e)}(y,e))}else{if(!l[h])return d?e:{};y=function(e,t,n,r){var o=e.constructor;switch(t){case"[object ArrayBuffer]":return pe(e);case"[object Boolean]":case"[object Date]":return new o(+e);case"[object DataView]":return function(e,t){var n=t?pe(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var n=t?pe(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,r);case a:return function(e,t,n){return j(t?n(x(e),!0):x(e),g,new e.constructor)}(e,r,n);case"[object Number]":case"[object String]":return new o(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,c.exec(e));return t.lastIndex=e.lastIndex,t}(e);case s:return function(e,t,n){return j(t?n(A(e),!0):A(e),_,new e.constructor)}(e,r,n);case"[object Symbol]":return i=e,re?Object(re.call(i)):{}}var i}(e,h,le,t)}}p||(p=new se);var w=p.get(e);if(w)return w;if(p.set(e,y),!b)var E=i?function(e){return function(e,t,n){var r=t(e);return we(e)?r:function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(r,n(e))}(e,ke,ve)}(e):ke(e);return function(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););}(E||e,(function(n,r){E&&(n=e[r=n]),ue(y,r,le(n,t,i,u,r,e,p))})),y}function de(e){return!(!Te(e)||(t=e,C&&C in t))&&(Oe(e)||m(e)?L:u).test(me(e));var t}function pe(e){var t=new e.constructor(e.byteLength);return new M(t).set(new M(e)),t}function ye(e,t,n,r){n||(n={});for(var o=-1,i=t.length;++o<i;){var a=t[o],s=r?r(n[a],e[a],a,n,e):void 0;ue(n,a,void 0===s?e[a]:s)}return n}function be(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function he(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return de(n)?n:void 0}oe.prototype.clear=function(){this.__data__=K?K(null):{}},oe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},oe.prototype.get=function(e){var t=this.__data__;if(K){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return $.call(t,e)?t[e]:void 0},oe.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:$.call(t,e)},oe.prototype.set=function(e,t){return this.__data__[e]=K&&void 0===t?"__lodash_hash_undefined__":t,this},ie.prototype.clear=function(){this.__data__=[]},ie.prototype.delete=function(e){var t=this.__data__,n=fe(t,e);return!(n<0)&&(n==t.length-1?t.pop():W.call(t,n,1),!0)},ie.prototype.get=function(e){var t=this.__data__,n=fe(t,e);return n<0?void 0:t[n][1]},ie.prototype.has=function(e){return fe(this.__data__,e)>-1},ie.prototype.set=function(e,t){var n=this.__data__,r=fe(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},ae.prototype.clear=function(){this.__data__={hash:new oe,map:new(J||ie),string:new oe}},ae.prototype.delete=function(e){return be(this,e).delete(e)},ae.prototype.get=function(e){return be(this,e).get(e)},ae.prototype.has=function(e){return be(this,e).has(e)},ae.prototype.set=function(e,t){return be(this,e).set(e,t),this},se.prototype.clear=function(){this.__data__=new ie},se.prototype.delete=function(e){return this.__data__.delete(e)},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ie){var r=n.__data__;if(!J||r.length<199)return r.push([e,t]),this;n=this.__data__=new ae(r)}return n.set(e,t),this};var ve=q?w(q,Object):function(){return[]},ge=function(e){return F.call(e)};function _e(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||f.test(e))&&e>-1&&e%1==0&&e<t}function je(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||k)}function me(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function xe(e,t){return e===t||e!=e&&t!=t}(z&&"[object DataView]"!=ge(new z(new ArrayBuffer(1)))||J&&ge(new J)!=a||H&&"[object Promise]"!=ge(H.resolve())||Y&&ge(new Y)!=s||G&&"[object WeakMap]"!=ge(new G))&&(ge=function(e){var t=F.call(e),n="[object Object]"==t?e.constructor:void 0,r=n?me(n):void 0;if(r)switch(r){case Q:return"[object DataView]";case X:return a;case Z:return"[object Promise]";case ee:return s;case te:return"[object WeakMap]"}return t});var we=Array.isArray;function Ae(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!Oe(e)}var Ee=R||function(){return!1};function Oe(e){var t=Te(e)?F.call(e):"";return t==r||t==o}function Te(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ke(e){return Ae(e)?ce(e):function(e){if(!je(e))return V(e);var t=[];for(var n in Object(e))$.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}e.exports=function(e){return le(e,!0,!0)}})),s=function(e={}){let t=e;const n=function(e,n){if(n&&!e)throw new Error('Error in Cache: key is null but value is defined. cache(null,"value"). But it should be: cache(), cache(key),cache(key,value)');return e&&t[e]?t[e]:(n&&(t[e]="function"==typeof n?n():n),e?t[e]:t)};return n.reset=function(){t={}},n};const c={directives:[],directivesObj:{},noDirectives:{},events:{onload:[]},dependencyEvaluationStrategy:e,expressionTypes:{js:t,"js-template-string":n},defaultExpressionTypes:["js","js-template-string"]};let u=a(c);const f=new s;new s;function l(e){const t={_localDumbeeCache:!0,bindings:{},dependencies:{}},n=function(e){const t=l.documentMock||document;let n=t.createElement("div");return function(e){try{return null!=e.tagName}catch(e){return!1}}(e.bindTo)&&(n=e.bindTo),e.bindTo&&(n=t.querySelector(e.bindTo)),e.template&&(n.innerHTML=e.template),n}(e=function(e={}){null==e.data&&(e.data={});return e}(e)),i=new Proxy(e.data,{set(e,n,r){e[n]=r,f.reset(),y(e,n,r);for(let r of t.dependencies[n])y(e,r,i[r]);return!0},get:(e,t)=>e[t]});for(let e of u.events.onload)e({cache:t,state:i,$root:n});function a(e="",t){const n=d(),r=Object.keys(n).map(e=>n[e]);return("string"==typeof e?s(e,t):e)(...r)}function s(e,t){const n=d("parsable");for(let r of t)try{const t=u.expressionTypes[r];if(null==t)throw`Expressiontype "${r}" does not exist. If the name is correct, please add it with "Dombee.addExpressionType('${r}', function(text,values){/*your code here*/})"`;return t(e,n)}catch(e){if("string"==typeof e)throw new Error(e)}throw new Error(`Expression ${e} can not be parsed.`)}function c(e="",n,r,a={}){const c=e.expression?e.expression.toString():e.toString(),f=u.dependencyEvaluationStrategy(c,i),l=function(e){return e&&e.expressionTypes?Array.isArray(e.expressionTypes)?e.expressionTypes:[e.expressionTypes]:u.defaultExpressionTypes}(a);for(let i of f)if(t.dependencies[i]||(t.dependencies[i]=[]),i!==n){const c=r?r+"_"+o(""):n;t.dependencies[i].push(c),t.bindings[c]={elemid:r,name:n,onChange:a.onChange,resultFn:s(e.expression?e.expression:e,l),resultFnRaw:e.expression?e.expression:e,expression:e,expressionTypes:l}}}function d(e){const t={};return Object.keys(i).forEach(n=>{let r=i[n],o=r;"function"==typeof r&&(r=r(i),o=r),null==r&&(o="''"),"string"==typeof r&&e&&(o=`'${r}'`),"object"==typeof r&&e&&(o=JSON.stringify(r)),t[n]=o}),t}function p(e){const t=e.toLowerCase();let n=u.directivesObj[t];if(n)return n;if(u.noDirectives[t])return[];for(let t of Object.keys(u.directivesObj))if(e.startsWith(t))return u.directivesObj[t];return u.noDirectives[t]=!0,[]}for(let e of u.directives){const t=r(e,{$root:n,state:i,values:d}),o=t.bindTo.toLowerCase();delete t.bindTo,u.directivesObj[o]||(u.directivesObj[o]=[]),u.directivesObj[o].push(t)}n.querySelectorAll("*").forEach(e=>{e.dataset||(e.dataset={});const t=e.dataset.id||o("id");for(let n of e.attributes){const r=p(n.name);for(let n of r){let r=n.expressions(e);if(null!=r){Array.isArray(r)||(r=[r]);for(let o of r)o&&(null==e.dataset.id&&(e.dataset.id=t),c(o,0,t,n))}}}});const y=(e,r,o)=>{const i=t.dependencies[r]||[];for(let e of i){const i=t.bindings[e],s=n.querySelector(`[data-id="${i.elemid}"]`),c=f(i.expression,()=>a(i.resultFn,i.expressionTypes));i.onChange&&i.onChange(s,c,{values:d,property:r,value:o,expression:i.expression,$root:n})}};return Object.keys(i).forEach(e=>{"function"==typeof i[e]&&c(i[e],e),y(i,e,i[e])}),{state:i,values:d(),watch:function(e,t){},cache:t,$root:n}}function d(e){u.events.onload.push(e)}function p(e){u.directives.push(e)}return Object.assign(l,{directive:p,dependencyEvaluationStrategy:function(e){if(null==e)throw new Error("fn is null but must be a function;");l.dependencyEvaluationStrategy=e},dependencyEvaluationStrategyDefault:e,addExpressionType:function(e,t){if(null==e)throw new Error("addExpressionType(name,fn) failed.  Name is undefined");if(null==t)throw new Error("addExpressionType(name,fn) failed. Function fn is undefined");if(getScope(this).globalCache.expressionTypes[e])throw new Error("addExpressionType(name,fn) failed. Expressiontype "+e+" already exists an can not be overwritten. Please choose another name");l.expressionTypes[e]=t},expressionTypeJs:t,expressionTypeJsTemplateString:n,addPlugin:function(e){e(l)},onLoad:d,globalCache:u,reset:function(){u=a(c),f.reset()},_id:o()}),p({name:"inputElementCheckboxes",bindTo:"data-model",expressions:e=>{if("input"!=!e.tagName&&"checkbox"==e.getAttribute("type"))return e.dataset.model},onChange(e,t,{property:n,value:r}){r?e.setAttribute("checked","checked"):e.removeAttribute("checked")}}),p((function(){return{bindTo:"data-model",expressions:e=>{if("input"!=!e.tagName&&"radio"!=e.getAttribute("type"))return e.dataset.model},onChange(e,t,{property:n,value:r}){e.value=r}}})),p((function(){return{bindTo:"data-model",expressions:e=>{if("input"!=!e.tagName&&"radio"===e.getAttribute("type"))return e.dataset.model},onChange(e,t,{property:n,value:r}){e.value==r&&e.setAttribute("checked","checked")}}})),p((function(){return{bindTo:"data-html",expressions:e=>e.dataset.html,onChange(e,t,n){e.innerHTML=t}}})),p((function(){return{bindTo:"data-text",expressions:e=>e.dataset.text,onChange(e,t,n){e.innerText=t}}})),p((function(){return{bindTo:"data-bind",expressions:e=>Object.keys(e.attributes).filter(t=>e.attributes[t].name.startsWith("data-bind:")||e.attributes[t].name.startsWith(":")).map(t=>{const n=e.attributes[t].name;return{expression:e.getAttribute(n),attributeName:n.replace("data-bind:","").replace(":","")}}),onChange(e,t,{expression:n}){e.setAttribute(n.attributeName,t)}}})),p((function(){return{bindTo:"data-class",expressions:e=>e.dataset.class,onChange(e,t,n){"object"==typeof t?Object.keys(t).forEach(n=>{t[n]?e.classList.add(n):e.classList.remove(n)}):e.setAttribute("class",t)}}})),p((function(){return{bindTo:"data-style",expressions:e=>e.dataset.style,onChange(e,t,n){"object"==typeof t?Object.keys(t).forEach(n=>{e.style[n]=t[n]}):e.setAttribute("style",t)}}})),p((function(){return{bindTo:"data-style:",expressions:e=>Object.keys(e.dataset).filter(e=>e.startsWith("style:")).map(t=>e.dataset[t]),onChange(e,t,{property:n}){e.style[n]=t}}})),p((function(){return{bindTo:"data-class:",expressions:e=>Object.keys(e.dataset).filter(e=>e.startsWith("class:")).map(t=>({expression:e.dataset[t],classname:t.replace("class:","")})),onChange(e,t,{property:n,value:r,expression:o}){t?e.classList.add(o.classname):e.classList.remove(o.classname)}}})),p((function(){return{bindTo:"data-show",expressions:e=>e.dataset.show,onChange(e,t){e.style.display=t?"block":"none"}}})),d((function({state:e,$root:t}){const n=t.querySelectorAll('[data-model]:not([type="checkbox"])'),r=t.querySelectorAll('input[data-model][type="checkbox"]');for(let t of n)t.addEventListener("keyup",(function(){const n=t.dataset.model;e[n]=t.value})),t.addEventListener("change",(function(){const n=t.dataset.model;e[n]=t.value}));for(let t of r)t.addEventListener("change",(function(){const n=t.dataset.model;e[n]=t.checked}))})),l}();
