!function(e){"use strict";const n={directives:[]};function t(e){let n=e;if("function"==typeof n&&(n=n()),null==n)throw new Error("Registerconfig.bindTo returns null but should return a selector, element, Array of elements or function that returns one of these.");return Array.isArray(n)?n:"string"==typeof n?document.querySelectorAll(n):[n]}e.Dombee=function(e={}){const o={bindings:{},dependencies:{}};function r(e){return e+Math.random().toString(36).substring(2,15)}const s=new Proxy(e,{set(e,n,t){e[n]=t,f(e,n,t);for(let t of o.dependencies[n])f(e,t,s[t]);return!0},get:(e,n)=>e[n]});function i(e=""){const n=d(),t=Object.keys(n).map(e=>n[e]);return("string"==typeof e?c(e):e)(...t)}function c(e){const n=d("parsable"),t=Object.keys(n);try{const n="return "+e+";";return Function(...t,n)}catch(n){try{const n="return `"+e+"`;";return Function(...t,n)}catch(e){console.log("code can not be parsed",codeNonString)}}}function u(e,n,t,i="",u){const d=e.expression?e.expression.toString():e.toString();Object.keys(s).forEach(s=>{if(d.match(new RegExp("\\b"+i+s+"\\b"))&&(o.dependencies[s]||(o.dependencies[s]=[]),s!==n)){const i=t?t+"_"+r(""):n;o.dependencies[s].push(i),o.bindings[i]={elemid:t,name:n,bindingFn:u,resultFn:c(e.expression?e.expression:e),resultFnRaw:e.expression?e.expression:e,expression:e}}})}function d(e){const n={};return Object.keys(s).forEach(t=>{let o=s[t],r=o;"function"==typeof o&&(o=o(s),r=o),null==o&&(r="''"),"string"==typeof o&&e&&(r=`'${o}'`),"object"==typeof o&&e&&(r=JSON.stringify(o)),n[t]=r}),n}for(let e of n.directives){let n="function"==typeof e?e({state:s,data:d()}):e;if(n=Object.assign({name:e.name},n),n.onRender){const e=t(n.bindTo);for(let t of e){const e=t.dataset.id||r("id_");null==t.dataset.id&&(t.dataset.id=e);let o=n.expressions(t);Array.isArray(o)||(o=[o]);for(let t of o)u(t,0,e,"",n.onRender)}}}const f=(e,n,t)=>{const r=o.dependencies[n]||[];for(let e of r){const r=o.bindings[e],s=document.querySelector(`[data-id="${r.elemid}"]`),c=i(r.resultFn);r.bindingFn&&r.bindingFn(s,c,{values:d,property:n,value:t,expression:r.expression})}};return Object.keys(s).forEach(e=>{"function"==typeof s[e]&&u(s[e],e),f(s,e,s[e])}),{state:s,values:d(),watch:function(e,n){},cache:o}},e.directive=function(e){n.directives.push(e)}}({});
